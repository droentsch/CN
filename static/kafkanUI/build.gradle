plugins {
    id "com.moowork.node" version "1.2.0"
}
apply plugin:'base'

node {
    version = '6.11.5'
    npmVersion = '3.10.10'
    download = true
}

task wrapper(type:Wrapper) {
    gradleVersion = '2.11'
}

def getTimestamp() {
    def date = new Date()
    return date.format('yyyyMMdd.HHmm')
}

def t = getTimestamp();

if (project.hasProperty('tag')) {
    t = tag;
}
def version = { tag -> "--tag=${tag}" }

task rebuild(type: NpmTask) {
    args = ['run', 'rebuild', '--', version(t) ]
}

task rebuildMin(type: NpmTask) {
    args = ['run', 'rebuildMin']
}

task start(type: NpmTask) {
    args = ['run', 'server']
}

task lint(type: NpmTask) {
    args = ['run', 'lint']
}

task test(type: NpmTask) {
    args = ['run', 'test']
}
